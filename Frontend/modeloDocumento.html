<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Modelos de Documento</title>

    <link href="CSS/tema.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        function AddNew(){
            // Busca a view para este dialogo
            var targetUrl = '../Frontend/views/novoModelo.html';
            $.get(targetUrl, function(response){
                var container = document.getElementById("container");
                if ( $( "#novoModelo" ).length == 0) {  // Verifica se o dialogo já existe na página
                    container.innerHTML = response;
                }
            });
            $('#novoModelo').modal('show');
        }
        function InserirNovo(){
            var id = 0;
            var targetUrl = "../Backend/_modeloDocumento/store.php";
            var callParameters = {'nome': $('input[name=nome]').val(), 'descricao': $('input[name=descricao]').val()};
            $.ajax({ type: 'POST', url: targetUrl, data: callParameters, success: function(response) { id = response; }, async: false });
        }
        function FecharDialogo(){
            $('#novoModelo').modal('hide');
        }
    </script>
</head>
<body>
    <div id="menu">
        <button type="button" class="btn btn-primary" onclick="AddNew();" >Novo Modelo</button>
    </div>
    <br/>
    <div id="container">
    </div>

    <script type="text/javascript" >
        $(document).ready(function() {
            function ParseResponse(response){
                var container = document.getElementById("container");

                var lista = JSON.parse(response);
                for(var item in lista) {
                    DisplayItem(lista[item]);
                }
            }

            function DisplayItem(modeloDocumento){
                var span = document.createElement('span');
                span.innerText = modeloDocumento.nome;
                container.appendChild(span);
                var editButton = document.createElement('img');
                editButton.src = 'images/edit.png';
                container.appendChild(editButton);
                var deleteButton = document.createElement('img');
                deleteButton.src = 'images/dump.png';
                container.appendChild(deleteButton);
                var lineBreak = document.createElement('br');
                container.appendChild(lineBreak);
            }

            var targetUrl = "../Backend/_modeloDocumento/retrieve.php";
            var callParameters = {'reg':''}; // Parâmetro vazio, retorna todos os registros
            $.ajax({ type: 'POST', url: targetUrl, data: callParameters, success: function(response) { ParseResponse(response); }, async: false });
        });
    </script>
</body>
</html>
